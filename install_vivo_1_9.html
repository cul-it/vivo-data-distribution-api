<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.7.4 at 2017-12-11 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Data Distribution API for VIVO &#x2013; Installing in VIVO 1.9</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                data-distribution-api
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
          
                <div class="xleft">
        <span id="publishDate">Last Published: 2017-12-11</span>
                  &nbsp;| <span id="projectVersion">Version: 1.1-SNAPSHOT</span>
                      </div>
            <div class="xright">      
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
           
                                <h5>Overview</h5>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="Introduction">Introduction</a>
            </li>
                  <li class="none">
                          <a href="motivation.html" title="Why another API?">Why another API?</a>
            </li>
                  <li class="none">
                          <a href="structure.html" title="How does it work?">How does it work?</a>
            </li>
                  <li class="none">
                          <a href="install_vivo_1_10.html" title="Install in VIVO 1.10">Install in VIVO 1.10</a>
            </li>
                  <li class="none">
            <strong>Install in VIVO 1.9</strong>
          </li>
                  <li class="none">
                          <a href="install_vivo_1_8.html" title="Install in VIVO 1.8">Install in VIVO 1.8</a>
            </li>
                  <li class="none">
                          <a href="configuration.html" title="Configuration">Configuration</a>
            </li>
                  <li class="none">
                          <a href="catalog.html" title="Implementations">Implementations</a>
            </li>
                  <li class="none">
                          <a href="cors.html" title="Cross-site distributions">Cross-site distributions</a>
            </li>
                  <li class="none">
                          <a href="apidocs/index.html" title="Javadoc">Javadoc</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                      <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                    <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                 
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <h1>Installing in VIVO 1.9</h1>
<p>Install the API in VIVO by following these steps:</p>

<ul>
  
<li>Edit <tt>{Vitro}/dependencies/pom.xml</tt>, adding the Data Distribution API as a dependency, from its own repository.</li>
  
<li>Edit <tt>web.xml</tt> in VIVO, or in your third tier, if you have one, to establish a <tt>servlet-mapping</tt> for the Data Distribution API.</li>
  
<li>Configure a sample distributor.</li>
  
<li>Build VIVO as you would normally.</li>
</ul>
<p>In these instructions, <tt>{VIVO}</tt> and <tt>{Vitro}</tt> are used to indicate the paths to the directories of the VIVO distribution. </p>
<p>More details are in the sections below.</p>
<div class="section">
<h2><a name="Edit_Vitrodependenciespom.xml"></a>Edit <tt>{Vitro}/dependencies/pom.xml</tt></h2>
<p>There are many <tt>&lt;dependency&gt;</tt> tags within the <tt>&lt;dependencies&gt;</tt> section of <tt>pom.xml</tt>. Add another dependency:</p>

<div class="source">
<div class="source">
<pre>  &lt;!-- Data Distribution API --&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;edu.cornell.library.scholars&lt;/groupId&gt;
    &lt;artifactId&gt;DataDistributionAPI_VIVO_1.9&lt;/artifactId&gt;
    &lt;version&gt;1.0&lt;/version&gt;
    &lt;type&gt;jar&lt;/type&gt;
  &lt;/dependency&gt;
</pre></div></div>
<p>There are no <tt>&lt;repository&gt;</tt> tags in <tt>pom.xml</tt>. Add one, telling Maven where to find the Data Distribution API:</p>

<div class="source">
<div class="source">
<pre>  &lt;!-- Reference the repository for the Data Distribution API. --&gt;
  &lt;repositories&gt;
    &lt;repository&gt;
      &lt;id&gt;data-distribution-api&lt;/id&gt;
      &lt;name&gt;DataDistributionAPI&lt;/name&gt;
      &lt;url&gt;https://raw.github.com/j2blake/DataDistributionAPI_VIVO_1.9/mvn-repo/&lt;/url&gt;
    &lt;/repository&gt;
  &lt;/repositories&gt;
    
</pre></div></div>
<p>Before editing, you might see this at the end of <tt>pom.xml</tt>:</p>
<p><img src="images/pom_xml_before.png" alt="pom.xml before editing" /></p>
<p>After editing, you would see this:</p>
<p><img src="images/pom_xml_after.png" alt="pom.xml after editing" /></p></div>
<div class="section">
<h2><a name="Edit_web.xml"></a>Edit <tt>web.xml</tt></h2>
<p>You may have several files named <tt>web.xml</tt> in your project. Each tier overrides the previous tier, so:</p>

<ul>
  
<li>if you are using a standard VIVO distribution, you will edit <tt>{VIVO}/webapp/src/main/webapp/web.xml</tt>.</li>
  
<li>If you have added a third tier, with its own <tt>web.xml</tt> file, you should edit that one instead.</li>
  
<li>If you have added a third tier, but it does not contain <tt>web.xml</tt>, you should edit the <tt>web.xml</tt> in VIVO, as above.</li>
</ul>
<p>Add a <tt>&lt;servlet&gt;</tt> tag and a <tt>&lt;servlet-mapping&gt;</tt> tag to associate the <tt>api/dataRequest</tt> with the <tt>DistributeDataApiController</tt>, like this:</p>

<div class="source">
<div class="source">
<pre>  &lt;!-- Data Distribution API --&gt;
  &lt;servlet&gt;
    &lt;servlet-name&gt;DistributeDataApi&lt;/servlet-name&gt;
    &lt;servlet-class&gt;edu.cornell.library.scholars.webapp.controller.api.DistributeDataApiController&lt;/servlet-class&gt;
  &lt;/servlet&gt;

  &lt;!-- Data Distribution API --&gt;
  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;DistributeDataApi&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/api/dataRequest/*&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;
</pre></div></div>
<p>These tags can be placed anywhere among the other servlet-related tags.</p>
<p>Before editing, you might see this in <tt>web.xml</tt>:</p>
<p><img src="images/web_xml_before.png" alt="web.xml before editing" /></p>
<p>After editing, you would see this:</p>
<p><img src="images/web_xml_after.png" alt="web.xml after editing" /></p></div>
<div class="section">
<h2><a name="Configure_a_distributor"></a>Configure a distributor</h2>
<p>Create a configuration file for the example distributor. The file will contain RDF data that tells the Data Distributor controller how to respond to requests. The file must be created in your VIVO distribution (or your third tier) in <tt>{VIVO}/home/src/main/resources/rdf/display/everytime</tt>.</p>
<p>For this example, create a file named <tt>HelloDistributorConfig.ttl</tt>:</p>

<div class="source">
<div class="source">
<pre>@prefix : &lt;http://vitro.mannlib.cornell.edu/ns/vitro/ApplicationSetup#&gt; .
  
:data_distributor_hello
    a   &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.DataDistributor&gt; ,
        &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.examples.HelloDistributor&gt; ;
    :actionName &quot;hello&quot; .
</pre></div></div></div>
<div class="section">
<h2><a name="Build_VIVO"></a>Build VIVO</h2>
<p>Run the Maven install script as you would normally.</p>
<h1>Does it work?</h1>
<p>Start your VIVO running and direct your browser to <tt>http://localhost:8080/vivo/api/dataRequest/hello?name=World</tt>. Your browser should display the following message:</p>

<div class="source">
<div class="source">
<pre>Hello, World! 
</pre></div></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                   2017.
          All rights reserved.    
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
