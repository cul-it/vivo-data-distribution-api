<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.7.4 at 2017-12-08 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Data Distribution API for VIVO &#x2013; How does the API work?</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                data-distribution-api
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
          
                <div class="xleft">
        <span id="publishDate">Last Published: 2017-12-08</span>
                  &nbsp;| <span id="projectVersion">Version: 1.0-SNAPSHOT</span>
                      </div>
            <div class="xright">      
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
           
                                <h5>Overview</h5>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="Introduction">Introduction</a>
            </li>
                  <li class="none">
                          <a href="motivation.html" title="Why another API?">Why another API?</a>
            </li>
                  <li class="none">
            <strong>How does it work?</strong>
          </li>
                  <li class="none">
                          <a href="install_vivo_1_10.html" title="Install in VIVO 1.10">Install in VIVO 1.10</a>
            </li>
                  <li class="none">
                          <a href="install_vivo_1_9.html" title="Install in VIVO 1.9">Install in VIVO 1.9</a>
            </li>
                  <li class="none">
                          <a href="install_vivo_1_8.html" title="Install in VIVO 1.8">Install in VIVO 1.8</a>
            </li>
                  <li class="none">
                          <a href="configuration.html" title="Configuration">Configuration</a>
            </li>
                  <li class="none">
                          <a href="catalog.html" title="Implementations">Implementations</a>
            </li>
                  <li class="none">
                          <a href="cors.html" title="Cross-site distributions">Cross-site distributions</a>
            </li>
                  <li class="none">
                          <a href="apidocs/index.html" title="Javadoc">Javadoc</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                    <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                    <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                 
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <h1>How does the API work?</h1>
<p>The Data Distribution API takes its configuration from VIVO&#x2019;s <i>content triple-store</i>. Usually this means that one or more files of RDF are placed in the VIVO home directory, to be loaded when VIVO starts up.</p>
<p>The Data Distribution API works with any Java object that implements the <tt>DataDistributor</tt> interface. However, the strategy has been to create a suite of general purpose distributors that can be configured for a variety of use cases. In this way, the RDF files may contain everything that is needed to provide a new data source.</p>
<div class="section">
<h2><a name="A_quick_example"></a>A quick example</h2>
<p>To illustrate, let&#x2019;s look at a simple request for data. The data will be used to populate a &#x201c;sunburst&#x201d; visualization in the browser. For now, the data is hard-coded in a file on the server, formatted to look like the response to a SPARQL SELECT query.</p>
<p>The relevant section of the configuration file might look like this:</p>

<div class="source">
<div class="source">
<pre>    :collaborations
        a   ddapi:file.FileDistributor ;
        :actionName &quot;collaboration_sunburst&quot; ;
        :path &quot;dataCache/cached_collab_data.json&quot; ;
        :contentType &quot;application/sparql-results+json&quot; .
</pre></div></div>
<p><tt>FileDistributor</tt> is one of the standard classes provided with the Data Distribution API. It simply copies the contents of a file into an HTTP response.</p>
<p>So, if the API controller receives a request like this:</p>

<div class="source">
<div class="source">
<pre>    http://scholars.cornell.edu/api/dataRequest/collaboration_sunburst
</pre></div></div>
<p>it will respond by </p>

<ul>
  
<li>creating an instance of the <tt>FileDistributor</tt> class,</li>
  
<li>providing the file path and content type to that instance, and</li>
  
<li>instructing the instance to create the HTTP response.</li>
</ul>
<p>As the &#x201c;sunburst&#x201d; visualization is developed, we might choose to drive it from data taken directly from the triple-store. In that case, the configuration file might look like this:</p>

<div class="source">
<div class="source">
<pre>    :collaborations
        a   ddapi:rdf.SelectFromContentDistributor ;
        :actionName &quot;collaboration_sunburst&quot; ;
        :query &quot;&quot;&quot;
          PREFIX vivo: &lt;http://vivoweb.org/ontology/core#&gt;
          SELECT *
          WHERE {
            ?grant a vivo:Grant .
            ?grant rdfs:label ?grantTitle .
          }
          &quot;&quot;&quot; .
</pre></div></div>
<p>Again, <tt>SelectFromContentDistributor</tt> is provided with the Data Distribution API. It executes a SPARQL SELECT query against the VIVO content models, and copies the result into an HTTP response.</p>
<p>Now, if the API controller receives the same request:</p>

<div class="source">
<div class="source">
<pre>    http://scholars.cornell.edu/api/dataRequest/collaboration_sunburst
</pre></div></div>
<p>it will respond by </p>

<ul>
  
<li>creating an instance of the <tt>SelectFromContentDistributor</tt> class,</li>
  
<li>providing the SPARQL SELECT query to that instance, and</li>
  
<li>instructing the instance to create the HTTP response.</li>
</ul>
<div class="section">
<h3><a name="Notes_on_the_example"></a>Notes on the example</h3>

<ul>
  
<li>
<p>Each type of request is identified by a name. The request might also accept parameters, although that wasn&#x2019;t shown in the example. JavaScript code on the browser requests data by that name and parameters. The JavaScript has no knowledge of how the response was produced. It merely requests the data set and creates a visualization from the response.</p></li>
  
<li>
<p>Each request type is configured by a site administrator, so there is no opportunity for users to make unexpected or unauthorized requests. </p></li>
  
<li>
<p>The actual source of the data is hidden from the JavaScript request. Site administrators are free to change the mechanism that provides the data, as shown in the example. </p></li>
</ul>
<h1>The implementation</h1>
<p><img src="images/DataDistributionApi_overview.png" alt="API overview" /></p>
<p>The <tt>display</tt> model in VIVO&#x2019;s configuration triple-store associates data requests with the means of satisfying them. The most common way to do this is to create one or more files of RDF to be loaded at startup.</p>
<p>The configuration for each request includes the name of a Java class that will supply the data, and any parameters that the class requires. The Java class implements the DataDistributor interface. The API controller asks the distributor class to produce the data, and the controller routes the data to the user.</p>
<p>One of the powerful concepts in this design is that the Java class can be written as special-purpose code for a single use, or as general-purpose code which can be configured for each use case. We expect to see more general-purpose <tt>DataDistributor</tt> classes, such as: </p>

<ul>
  
<li><tt>SolrDistributor</tt>, for queries against the search index.</li>
  
<li><tt>HttpRelayDistributor</tt>, for queries against services at other sites.</li>
</ul>
<p>In spite of this, special-purpose code will remain the best solution for some unusual data sets.</p></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                   2017.
          All rights reserved.    
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
