<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.7.4 at 2017-12-06 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Data Distribution API for VIVO &#x2013; Implementations provided</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                data-distribution-api
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
          
                <div class="xleft">
        <span id="publishDate">Last Published: 2017-12-06</span>
                  &nbsp;| <span id="projectVersion">Version: 1.1</span>
                      </div>
            <div class="xright">      
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
           
                                <h5>Overview</h5>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="Introduction">Introduction</a>
            </li>
                  <li class="none">
                          <a href="motivation.html" title="Why another API?">Why another API?</a>
            </li>
                  <li class="none">
                          <a href="structure.html" title="How does it work?">How does it work?</a>
            </li>
                  <li class="none">
                          <a href="install_vivo_1_10.html" title="Install in VIVO 1.10">Install in VIVO 1.10</a>
            </li>
                  <li class="none">
                          <a href="install_vivo_1_9.html" title="Install in VIVO 1.9">Install in VIVO 1.9</a>
            </li>
                  <li class="none">
                          <a href="install_vivo_1_8.html" title="Install in VIVO 1.8">Install in VIVO 1.8</a>
            </li>
                  <li class="none">
                          <a href="configuration.html" title="Configuration">Configuration</a>
            </li>
                  <li class="none">
            <strong>Implementations</strong>
          </li>
                  <li class="none">
                          <a href="cors.html" title="Cross-site distributions">Cross-site distributions</a>
            </li>
                  <li class="none">
                          <a href="apidocs/index.html" title="Javadoc">Javadoc</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                    <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                    <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                 
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <h1>Implementations provided</h1>
<p>The Data Distribution API is intended to be extensible, and developers are encouraged to create their own <tt>DataDistributor</tt> classes. However, many sites will find that the existing implementations are sufficient for their needs.</p>

<ul>
  
<li><a href="#aexample_package"><tt>/example</tt> package</a>
  
<ul>
    
<li><a href="#HelloDistributor"><tt>HelloDistributor</tt></a></li>
  </ul></li>
  
<li><a href="#afile_package"><tt>/file</tt> package</a>
  
<ul>
    
<li><a href="#FileDistributor"><tt>FileDistributor</tt></a></li>
    
<li><a href="#SelectingFileDistributor"><tt>SelectingFileDistributor</tt></a></li>
  </ul></li>
  
<li><a href="#ardf_package"><tt>/rdf</tt> package</a>
  
<ul>
    
<li><a href="#SelectFromContentDistributor"><tt>SelectFromContentDistributor</tt></a></li>
    
<li><a href="#RdfGraphDistributor"><tt>RdfGraphDistributor</tt></a></li>
    
<li><a href="#SelectFromGraphDistributor"><tt>SelectFromGraphDistributor</tt></a></li>
  </ul></li>
  
<li><a href="#ardfgraphbuilder_package"><tt>/rdf/graphbuilder</tt> package</a>
  
<ul>
    
<li><a href="#EmptyGraphBuilder"><tt>EmptyGraphBuilder</tt></a></li>
    
<li><a href="#ConstructQueryGraphBuilder"><tt>ConstructQueryGraphBuilder</tt></a></li>
    
<li><a href="#IteratingGraphBuilder"><tt>IteratingGraphBuilder</tt></a></li>
    
<li><a href="#DrillDownGraphBuilder"><tt>DrillDownGraphBuilder</tt></a></li>
  </ul></li>
  
<li><a href="#adecorator_package"><tt>/decorator</tt> package</a>
  
<ul>
    
<li><a href="#JavaScriptTransformDistributor"><tt>JavaScriptTransformDistributor</tt></a></li>
  </ul></li>
</ul>
<div class="section">
<h2><a name="aexample_package"></a>/example package</h2>
<div class="section">
<h3><a name="HelloDistributor"></a><tt>HelloDistributor</tt></h3>
<p><img src="images/uml_HelloDistributor.png" alt="UML for HelloDistributor" /></p>
<p><b>Description</b></p>
<p>A simple implementation, used for demonstrating the installation procedures.</p>
<p><b>Configuration properties</b></p>

<table border="0" class="bodyTable">
  <thead>
    
<tr class="a">
      
<th>Property </th>
      
<th>Meaning </th>
      
<th>How many? </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td><tt>actionName</tt> </td>
      
<td>Associates the instance with an HTTP request. </td>
      
<td>exactly one </td>
    </tr>
  </tbody>
</table>
<p><b>Request parameters</b></p>

<table border="0" class="bodyTable">
  <thead>
    
<tr class="a">
      
<th>Parameter </th>
      
<th>Meaning </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td>name </td>
      
<td>The name that will be echoed in the response </td>
    </tr>
  </tbody>
</table>
<p><b>Example configuration:</b> </p>

<div class="source">
<div class="source">
<pre>@prefix : &lt;http://vitro.mannlib.cornell.edu/ns/vitro/ApplicationSetup#&gt; .

:data_distributor_hello
    a   &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.DataDistributor&gt; ,
        &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.examples.HelloDistributor&gt; ;
    :actionName &quot;hello&quot; .
</pre></div></div>
<p><b>Example request:</b> </p>

<div class="source">
<div class="source">
<pre>http://localhost:8080/vivo/api/dataRequest/hello?name=World
</pre></div></div>
<hr /></div></div>
<div class="section">
<h2><a name="afile_package"></a>/file package</h2>
<div class="section">
<h3><a name="FileDistributor"></a><tt>FileDistributor</tt></h3>
<p><img src="images/uml_FileDistributor.png" alt="UML for FileDistributor" /></p>
<p><b>Description</b></p>
<p>Sends the contents of a file as an HTTP response. </p>
<p><b>Configuration properties</b></p>

<table border="0" class="bodyTable">
  <thead>
    
<tr class="a">
      
<th>Parameter </th>
      
<th>Meaning </th>
      
<th>How many? </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td><tt>actionName</tt> </td>
      
<td>Associates the instance with an HTTP request. </td>
      
<td>exactly one </td>
    </tr>
    
<tr class="a">
      
<td><tt>contentType</tt> </td>
      
<td>The MIME type to be sent in the HTTP response header. </td>
      
<td>exactly one </td>
    </tr>
    
<tr class="b">
      
<td><tt>path</tt> </td>
      
<td>The location of the file. If a relative path, it is relative to the Vitro home directory. </td>
      
<td>exactly one </td>
    </tr>
  </tbody>
</table>
<p><b>Request parameters</b></p>

<table border="0" class="bodyTable">
  <thead>
    
<tr class="a">
      
<th>Parameter </th>
      
<th>Meaning </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td><i>none</i> </td>
      
<td> </td>
    </tr>
  </tbody>
</table>
<p><b>Example configuration:</b> </p>

<div class="source">
<div class="source">
<pre>@prefix : &lt;http://vitro.mannlib.cornell.edu/ns/vitro/ApplicationSetup#&gt; .

:data_distributor_organization_research_areas
    a   &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.DataDistributor&gt; ,
        &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.file.FileDistributor&gt; ;
    :actionName &quot;research_areas&quot; ;
    :contentType &quot;text/turtle&quot; .
    :path &quot;visualizationData/bme_research_areas.ttl&quot; ;
</pre></div></div>
<p><b>Example request:</b> </p>

<div class="source">
<div class="source">
<pre>http://localhost:8080/vivo/api/dataRequest/research_areas
</pre></div></div>
<hr /></div>
<div class="section">
<h3><a name="SelectingFileDistributor"></a><tt>SelectingFileDistributor</tt></h3>
<p><img src="images/uml_SelectingFileDistributor.png" alt="UML for SelectingFileDistributor" /></p>
<p><b>Description</b></p>
<p>Serves the contents of a file. Selects the file by extracting a value from the HTTP request, and using it to construct the file path.</p>
<p><b>Configuration properties</b></p>

<table border="0" class="bodyTable">
  <thead>
    
<tr class="a">
      
<th>Parameter </th>
      
<th>Meaning </th>
      
<th>How many? </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td><tt>actionName</tt> </td>
      
<td>Associates the instance with an HTTP request. </td>
      
<td>exactly one </td>
    </tr>
    
<tr class="a">
      
<td><tt>contentType</tt> </td>
      
<td>The MIME type to be sent in the HTTP response header. </td>
      
<td>exactly one </td>
    </tr>
    
<tr class="b">
      
<td><tt>parameterName</tt> </td>
      
<td>The request parameter that will contain the file selector. </td>
      
<td>exactly one </td>
    </tr>
    
<tr class="a">
      
<td><tt>parameterPattern</tt> </td>
      
<td>A regular expression to extract the file selector from the parameter value. </td>
      
<td>exactly one </td>
    </tr>
    
<tr class="b">
      
<td><tt>filepathTemplate</tt> </td>
      
<td>A template for constructing the file path from the selection value. If the constructed path is relative, it is relative to the Vitro home directory. </td>
      
<td>exactly one </td>
    </tr>
    
<tr class="a">
      
<td><tt>emptyResponse</tt> </td>
      
<td>A string to be served as an &#x201c;empty data set&#x201d;, if the file is not found. </td>
      
<td>exactly one </td>
    </tr>
  </tbody>
</table>
<p><b>Request parameters</b></p>

<table border="0" class="bodyTable">
  <thead>
    
<tr class="a">
      
<th>Parameter </th>
      
<th>Meaning </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td><i>named in the configuration</i></td>
      
<td>Provides a file selector value. </td>
    </tr>
  </tbody>
</table>
<p><b>Example configuration:</b> </p>

<div class="source">
<div class="source">
<pre>@prefix : &lt;http://vitro.mannlib.cornell.edu/ns/vitro/ApplicationSetup#&gt; .

:sf_distributor
  a   &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.DataDistributor&gt; ,
      &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.file.SelectingFileDistributor&gt; ;
  :actionName &quot;collaboration_sunburst&quot; ;
  :contentType &quot;application/json&quot; ;
  :parameterName &quot;department&quot; ;
  :parameterPattern &quot;[^/#]+$&quot;;
  :filepathTemplate &quot;crossunit-\\0.json&quot; ;
  :emptyResponse &quot;[]&quot; .
</pre></div></div>
<p><b>Example request:</b> </p>

<div class="source">
<div class="source">
<pre>http://localhost:8080/vivo/api/dataRequest/collaboration_sunburst?department=http%3A%2F%2Fmy.domain.edu%2Findividual%2Fn1234
</pre></div></div>
<hr /></div></div>
<div class="section">
<h2><a name="ardf_package"></a>/rdf package</h2>
<div class="section">
<h3><a name="SelectFromContentDistributor"></a><tt>SelectFromContentDistributor</tt></h3>
<p><img src="images/uml_SelectFromContentDistributor.png" alt="UML for SelectFromContentDistributor" /></p>
<p><b>Description</b></p>
<p>Executes a SPARQL SELECT query against Vitro&#x2019;s content triple-store, and returns the results in JSON format: <tt>application/sparql-results+json</tt>.</p>
<p>You may specify the names of variables in the SPARQL query that should be bound to request parameters before the query is executed. Each value may be bound as a URI or as a plain literal value. If the request does not contain exactly one parameter for each specified binding, the response will be <tt>400 Bad Request</tt> with an informative message.</p>
<p><b>Configuration properties</b></p>

<table border="0" class="bodyTable">
  <thead>
    
<tr class="a">
      
<th>Parameter </th>
      
<th>Meaning </th>
      
<th>How many? </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td><tt>actionName</tt> </td>
      
<td>as above </td>
      
<td>exactly one </td>
    </tr>
    
<tr class="a">
      
<td><tt>query</tt> </td>
      
<td>The SPARQL SELECT query. </td>
      
<td>exactly one </td>
    </tr>
    
<tr class="b">
      
<td><tt>uriBinding</tt> </td>
      
<td>The name of a request parameter whose value should be bound in the query as a URI. </td>
      
<td>zero or more </td>
    </tr>
    
<tr class="a">
      
<td><tt>literalBinding</tt> </td>
      
<td>The name of a request parameter whose value should be bound in the query as a plain literal. </td>
      
<td>zero or more </td>
    </tr>
  </tbody>
</table>
<p><b>Request parameters</b></p>

<table border="0" class="bodyTable">
  <thead>
    
<tr class="a">
      
<th>Parameter </th>
      
<th>Meaning </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td><i>as named in the configuration</i> </td>
      
<td>Values to be bound as URIs in the SPARQL query. </td>
    </tr>
    
<tr class="a">
      
<td><i>as named in the configuration</i> </td>
      
<td>Values to be bound as plain literals in the SPARQL query. </td>
    </tr>
  </tbody>
</table>
<p><b>Example configuration:</b> </p>

<div class="source">
<div class="source">
<pre>@prefix      : &lt;http://vitro.mannlib.cornell.edu/ns/vitro/ApplicationSetup#&gt; .

:sample_select_from_content_distributor
    a   &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.DataDistributor&gt; ,
        &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.rdf.SelectFromContentDistributor&gt; ;
    :actionName &quot;sampleAction&quot; ;
    :query &quot;&quot;&quot;
      PREFIX foo: &amp;lt;http://some.silly.domain/foo#&amp;gt;
      SELECT ?article
      WHERE {
        ?person foo:isAuthor ?article .
        ?article foo:hasTopic ?topic .
      }
    &quot;&quot;&quot; ;
    :uriBinding &quot;person&quot; ;
    :literalBinding &quot;topic&quot; .
</pre></div></div>
<p><b>Example request:</b> </p>

<div class="source">
<div class="source">
<pre>http://localhost:8080/vivo/api//sampleAction?person=http%3A%2F%2Fmy.domain.edu%2Findividual%2Fn1234&amp;topic=Oncology
</pre></div></div>
<hr /></div>
<div class="section">
<h3><a name="RdfGraphDistributor"></a><tt>RdfGraphDistributor</tt></h3>
<p><img src="images/uml_RdfGraphDistributor.png" alt="UML for RdfGraphDistributor" /></p>
<p><b>Description</b></p>
<p>Executes one or more <a href="#ardfgraphbuilder_package"><tt>GraphBuilder</tt></a> instances. Merges the results into an internal RDF graph, and returns that graph in Turtle format: <tt>text/turtle</tt>.</p>
<p>The <tt>GraphBuilder</tt> instances may accept configuration parameters, as specified for the class of each <tt>GraphBuilder</tt>.</p>
<p><b>Configuration properties</b></p>

<table border="0" class="bodyTable">
  <thead>
    
<tr class="a">
      
<th>Parameter </th>
      
<th>Meaning </th>
      
<th>How many? </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td><tt>actionName</tt> </td>
      
<td>Associates the instance with an HTTP request. </td>
      
<td>exactly one </td>
    </tr>
    
<tr class="a">
      
<td><tt>graphBuilder</tt> </td>
      
<td>Creates the internal RDF graph. </td>
      
<td>one or more </td>
    </tr>
  </tbody>
</table>
<p><b>Request parameters</b></p>

<table border="0" class="bodyTable">
  <thead>
    
<tr class="a">
      
<th>Parameter </th>
      
<th>Meaning </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td><i>as permitted for graph builders</i> </td>
      
<td>See the description of the relevant <tt>GraphBuilder</tt>(s). </td>
    </tr>
  </tbody>
</table>
<p><b>Example configuration:</b> </p>

<div class="source">
<div class="source">
<pre>@prefix      : &lt;http://vitro.mannlib.cornell.edu/ns/vitro/ApplicationSetup#&gt; .

:data_distributor_mapping
    a   &lt;java:edu.cornell.mannlib.vitro.webapp.controller.api.distribute.DataDistributor&gt; ,
        &lt;java:edu.cornell.mannlib.vitro.webapp.controller.api.distribute.rdf.RdfGraphDistributor&gt; ;
    :actionName &quot;mapper&quot; ;
    :graphBuilder :mapping_graph_builder ;
    
:mapping_graph_builder
    a   &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.rdf.graphbuilder.GraphBuilder&gt; ,
        &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.rdf.graphbuilder.ConstructQueryGraphBuilder&gt; ;
    :uriBinding &quot;person&quot; ;
    :constructQuery &quot;&quot;&quot;
      PREFIX rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;
      PREFIX vivo: &lt;http://vivoweb.org/ontology/core#&gt;
      CONSTRUCT {
        ?pub rdfs:label ?articleName .
      } WHERE {
        ?person vivo:relatedBy ?auth .
        ?auth a vivo:Authorship .
        ?auth vivo:relates ?pub .
        ?pub rdfs:label ?articleName .
      }
    &quot;&quot;&quot; .
</pre></div></div>
<p><b>Example request:</b> </p>

<div class="source">
<div class="source">
<pre>http://localhost:8080/vivo/api/mapper?person=http%3A%2F%2Fmy.domain.edu%2Findividual%2Fn1234
</pre></div></div>
<hr /></div>
<div class="section">
<h3><a name="SelectFromGraphDistributor"></a><tt>SelectFromGraphDistributor</tt></h3>
<p><img src="images/uml_SelectFromGraphDistributor.png" alt="UML for SelectFromGraphDistributor" /></p>
<p><b>Description</b></p>
<p>Executes a SPARQL SELECT query against an internal RDF graph. The graph is created by merging the outputs of one or more <tt>GraphBuilder</tt> instances. The results are returned in JSON format: application/sparql-results+json.</p>
<p>This is commonly used as a way to issue a complicated SELECT query against a subset of the content triple-store, when querying the full triple-store would take too long. The internal graph is built from one or more CONSTRUCT queries, and the SELECT query is executed on the resulting model.</p>
<p>However, it is not restricted to such use. The internal graph may be built from any source of data (see the <a href="#ardfgraphbuilder_package"><tt>GraphBuilder</tt></a> classes, below).</p>
<p>You may bind values from the HTTP request to variables in the SELECT query as specified in <a href="#SelectFromContentDistributor"><tt>SelectFromContentDistributor</tt></a>. The <tt>GraphBuilder</tt> instances may also accept configuration parameters, as specified for the class of each <tt>GraphBuilder</tt>.</p>
<p><b>Configuration properties</b></p>

<table border="0" class="bodyTable">
  <thead>
    
<tr class="a">
      
<th>Parameter </th>
      
<th>Meaning </th>
      
<th>How many? </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td><tt>actionName</tt> </td>
      
<td>Associates the instance with an HTTP request. </td>
      
<td>exactly one </td>
    </tr>
    
<tr class="a">
      
<td><tt>query</tt> </td>
      
<td>The SPARQL SELECT query. </td>
      
<td>exactly one </td>
    </tr>
    
<tr class="b">
      
<td><tt>uriBinding</tt> </td>
      
<td>See <a href="#SelectFromContentDistributor"><tt>SelectFromContentDistributor</tt></a>. </td>
      
<td>zero or more </td>
    </tr>
    
<tr class="a">
      
<td><tt>literalBinding</tt> </td>
      
<td>See <a href="#SelectFromContentDistributor"><tt>SelectFromContentDistributor</tt></a>. </td>
      
<td>zero or more </td>
    </tr>
    
<tr class="b">
      
<td><tt>graphBuilder</tt> </td>
      
<td>Creates the local RDF graph, which the SPARQL SELECT query will run against. </td>
      
<td>one or more </td>
    </tr>
  </tbody>
</table>
<p><b>Request parameters</b></p>

<table border="0" class="bodyTable">
  <thead>
    
<tr class="a">
      
<th>Parameter </th>
      
<th>Meaning </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td><i>as named in the configuration</i> </td>
      
<td>See <a href="#SelectFromContentDistributor"><tt>SelectFromContentDistributor</tt></a>. </td>
    </tr>
    
<tr class="a">
      
<td><i>as permitted for graph builders</i> </td>
      
<td>See the description of the relevant <tt>GraphBuilder</tt>(s). </td>
    </tr>
  </tbody>
</table>
<p><b>Example configuration:</b> </p>

<div class="source">
<div class="source">
<pre>@prefix      : &lt;http://vitro.mannlib.cornell.edu/ns/vitro/ApplicationSetup#&gt; .

:from_graph_distributor
    a   &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.DataDistributor&gt; ,
        &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.rdf.SelectFromGraphDistributor&gt; ;
    :actionName &quot;fromGraph&quot; ;
    :query &quot;&quot;&quot;
      PREFIX rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;
      SELECT ?person ?article
      WHERE {
        ?article rdfs:label ?articleName .
      }
    &quot;&quot;&quot; ;
    :uriBinding &quot;person&quot; ;
    :literalBinding &quot;topic&quot; ;
    :graphBuilder :from_graph_builder .
    
:from_graph_builder
    a   &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.rdf.graphbuilder.GraphBuilder&gt; ,
        &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.rdf.graphbuilder.ConstructQueryGraphBuilder&gt; ;
    :uriBinding &quot;person&quot; ;
    :constructQuery &quot;&quot;&quot;
      PREFIX rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;
      PREFIX vivo: &lt;http://vivoweb.org/ontology/core#&gt;
      CONSTRUCT {
        ?pub rdfs:label ?articleName .
      } WHERE {
        ?person vivo:relatedBy ?auth .
        ?auth a vivo:Authorship .
        ?auth vivo:relates ?pub .
        ?pub rdfs:label ?articleName .
      }
    &quot;&quot;&quot; .
</pre></div></div>
<p><b>Example request:</b> </p>

<div class="source">
<div class="source">
<pre>http://localhost:8080/vivo/api/fromGraph?person=http%3A%2F%2Fmy.domain.edu%2Findividual%2Fn1234
</pre></div></div>
<hr /></div></div>
<div class="section">
<h2><a name="ardfgraphbuilder_package"></a>/rdf/graphbuilder package</h2>
<p>As shown in the previous section, some <tt>DataDistributor</tt> instances are configured with one or more <tt>GraphBuilder</tt> instances, to build an RDF graph which is used in building the HTTP response.</p>
<div class="section">
<h3><a name="EmptyGraphBuilder"></a>EmptyGraphBuilder</h3>
<p><img src="images/uml_EmptyGraphBuilder.png" alt="UML for EmptyGraphBuilder" /></p>
<p><b>Description</b></p>
<p>Creates an RDF graph containing no triples. Used for tests, examples, or placeholders.</p>
<p><b>Configuration properties</b></p>

<table border="0" class="bodyTable">
  <thead>
    
<tr class="a">
      
<th>Parameter </th>
      
<th>Meaning </th>
      
<th>How many? </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td><i>none</i> </td>
      
<td> </td>
      
<td> </td>
    </tr>
  </tbody>
</table>
<p><b>Request parameters</b></p>

<table border="0" class="bodyTable">
  <thead>
    
<tr class="a">
      
<th>Parameter </th>
      
<th>Meaning </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td><i>none</i> </td>
      
<td> </td>
    </tr>
  </tbody>
</table>
<p><b>Example configuration:</b> </p>

<div class="source">
<div class="source">
<pre>@prefix      : &lt;http://vitro.mannlib.cornell.edu/ns/vitro/ApplicationSetup#&gt; .

:placeholder
    a   &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.rdf.graphbuilder.GraphBuilder&gt; ,
        &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.rdf.graphbuilder.EmptyGraphBuilder&gt; .
</pre></div></div>
<hr /></div>
<div class="section">
<h3><a name="ConstructQueryGraphBuilder"></a>ConstructQueryGraphBuilder</h3>
<p><img src="images/uml_ConstructQueryGraphBuilder.png" alt="UML for ConstructQueryGraphBuilder" /></p>
<p><b>Description</b></p>
<p>Executes SPARQL CONSTRUCT query(s) against Vitro&#x2019;s content triple-store, and returns a model that contains the (merged) results.</p>
<p>Bindings for URI values or plain literal values are available as described above for <a href="#SelectFromContentDistributor"><tt>SelectFromContentDistributor</tt></a>.</p>
<p><b>Configuration properties</b></p>

<table border="0" class="bodyTable">
  <thead>
    
<tr class="a">
      
<th>Parameter </th>
      
<th>Meaning </th>
      
<th>How many? </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td><tt>constructQuery</tt> </td>
      
<td>The SPARQL CONSTRUCT query. </td>
      
<td>one or more </td>
    </tr>
    
<tr class="a">
      
<td><tt>uriBinding</tt> </td>
      
<td>See <a href="#SelectFromContentDistributor"><tt>SelectFromContentDistributor</tt></a>. </td>
      
<td>zero or more </td>
    </tr>
    
<tr class="b">
      
<td><tt>literalBinding</tt> </td>
      
<td>See <a href="#SelectFromContentDistributor"><tt>SelectFromContentDistributor</tt></a>. </td>
      
<td>zero or more </td>
    </tr>
  </tbody>
</table>
<p><b>Request parameters</b></p>

<table border="0" class="bodyTable">
  <thead>
    
<tr class="a">
      
<th>Parameter </th>
      
<th>Meaning </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td><i>as named in the configuration</i> </td>
      
<td>See <a href="#SelectFromContentDistributor"><tt>SelectFromContentDistributor</tt></a>. </td>
    </tr>
  </tbody>
</table>
<p><b>Example configuration:</b> </p>

<div class="source">
<div class="source">
<pre>@prefix      : &lt;http://vitro.mannlib.cornell.edu/ns/vitro/ApplicationSetup#&gt; .

:authors_graph_builder
    a   &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.rdf.graphbuilder.GraphBuilder&gt; ,
        &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.rdf.graphbuilder.ConstructQueryGraphBuilder&gt; ;
    :uriBinding &quot;person&quot; ;
    :constructQuery &quot;&quot;&quot;
      PREFIX vivo: &lt;http://vivoweb.org/ontology/core#&gt;
      CONSTRUCT {
        ?person vivo:relatedBy ?auth .
        ?auth a vivo:Authorship .
        ?auth vivo:relates ?pub .
      } WHERE {
        ?person vivo:relatedBy ?auth .
        ?auth a vivo:Authorship .
        ?auth vivo:relates ?pub .
      }
    &quot;&quot;&quot; .

</pre></div></div>
<hr /></div>
<div class="section">
<h3><a name="IteratingGraphBuilder"></a>IteratingGraphBuilder</h3>
<p><img src="images/uml_IteratingGraphBuilder.png" alt="UML for IteratingGraphBuilder" /></p>
<p><b>Description</b></p>
<p>A <tt>GraphBuilder</tt> decorator that runs one or more &#x201c;child&#x201d; builders multiple times, each time providing a different value for a specified request parameter. The results of all queries are merged into a local RDF graph.</p>
<p>This permits the easy execution of multiple SPARQL queries that differ only in the value of a bound variable.</p>
<p><b>Configuration properties</b></p>

<table border="0" class="bodyTable">
  <thead>
    
<tr class="a">
      
<th>Parameter </th>
      
<th>Meaning </th>
      
<th>How many? </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td><tt>parameterName</tt> </td>
      
<td>the request parameter that will be augmented when running the <tt>childGraphBuilder</tt>(s). </td>
      
<td>exactly one </td>
    </tr>
    
<tr class="a">
      
<td><tt>parameterValue</tt> </td>
      
<td>the values that will be added to the named parameter, one value for each run of the <tt>childGraphBuilder</tt>(s). </td>
      
<td>one or more </td>
    </tr>
    
<tr class="b">
      
<td><tt>childGraphBuilder</tt> </td>
      
<td>The &#x201c;decorated&#x201d; <tt>GraphBuilder</tt> instance(s), which will produce the RDF graph. </td>
      
<td>one or more </td>
    </tr>
  </tbody>
</table>
<p><b>Request parameters</b></p>

<table border="0" class="bodyTable">
  <thead>
    
<tr class="a">
      
<th>Parameter </th>
      
<th>Meaning </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td><i>none</i> </td>
      
<td> </td>
    </tr>
  </tbody>
</table>
<p><b>Example configuration:</b> </p>

<div class="source">
<div class="source">
<pre>@prefix      : &lt;http://vitro.mannlib.cornell.edu/ns/vitro/ApplicationSetup#&gt; .

:iterating_graph_builder
    a   &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.rdf.graphbuilder.GraphBuilder&gt; ,
        &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.rdf.graphbuilder.IteratingGraphBuilder&gt; ;
    :parameterName &quot;subjectArea&quot; ;
    :parameterValue &quot;cancer&quot;, &quot;tissues&quot;, &quot;echidnae&quot; ;
    :childGraphBuilder :subordinate_graph_builder .

:subordinate_graph_builder
    a   &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.rdf.graphbuilder.GraphBuilder&gt; ,
        &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.rdf.graphbuilder.ConstructQueryGraphBuilder&gt; ;
    :literalBinding &quot;subjectArea&quot; ;
    :constructQuery &quot;&quot;&quot;
      PREFIX foo: &amp;lt;http://some.silly.domain/foo#&amp;gt;
      CONSTRUCT {
        ?article foo:hasKeyword ?subjectArea .
      }
      WHERE {
        ?article foo:hasKeyword ?subjectArea .
      }
    &quot;&quot;&quot; .
</pre></div></div>
<hr /></div>
<div class="section">
<h3><a name="DrillDownGraphBuilder"></a>DrillDownGraphBuilder</h3>
<p><img src="images/uml_DrillDownGraphBuilder.png" alt="UML for DrillDownGraphBuilder" /></p>
<p><b>Description</b></p>
<p>A <tt>GraphBuilder</tt> decorator that runs one or more &#x201c;child&#x201d; builders multiple times, each time providing a different value for a specified request parameter. The results of all queries are merged into a local RDF graph.</p>
<p>A top-level <tt>GraphBuilder</tt> is run, and a SPARQL SELECT query is run against the resulting graph, to obtain a list of values. This list of values is then used to iterate over the child <tt>GraphBuilder</tt> instances.</p>
<p>This is similar to <a href="#IteratingGraphBuilder"><tt>IteratingGraphBuilder</tt></a>, but the values for the request parameter are not specified in the configuration. Instead they are discovered, using the top-level <tt>GraphBuilder</tt> and the configured SPARQL SELECT query.</p>
<p>Note that a SPARQL SELECT query may return more than one named value for each result. In that case, each set of values will be used in turn to augment the request parameters as seen by the child <tt>GraphBuilder</tt>(s).</p>
<p><b>Configuration properties</b></p>

<table border="0" class="bodyTable">
  <thead>
    
<tr class="a">
      
<th>Parameter </th>
      
<th>Meaning </th>
      
<th>How many? </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td><tt>topLevelGraphBuilder</tt> </td>
      
<td>The source of the top-level graph, against which the <tt>drillDownQuery</tt> is run. </td>
      
<td>exactly one </td>
    </tr>
    
<tr class="a">
      
<td><tt>drillDownQuery</tt> </td>
      
<td>Discovers the values that will be passed to the child <tt>GraphBuilder</tt> instance(s). </td>
      
<td>exactly one </td>
    </tr>
    
<tr class="b">
      
<td><tt>childGraphBuilder</tt> </td>
      
<td>The &#x201c;decorated&#x201d; <tt>GraphBuilder</tt> instance(s), which will produce the RDF graph. </td>
      
<td>one or more </td>
    </tr>
    
<tr class="a">
      
<td><tt>uriBinding</tt> </td>
      
<td>See <a href="#SelectFromContentDistributor"><tt>SelectFromContentDistributor</tt></a>. These bindings will be applied to the <tt>drillDownQuery</tt>. They are not passed on to the <tt>childGraphBuilder</tt> instance(s). </td>
      
<td>zero or more </td>
    </tr>
    
<tr class="b">
      
<td><tt>literalBinding</tt> </td>
      
<td>See <a href="#SelectFromContentDistributor"><tt>SelectFromContentDistributor</tt></a>. These bindings will be applied to the <tt>drillDownQuery</tt>. They are not passed on to the <tt>childGraphBuilder</tt> instance(s). </td>
      
<td>zero or more </td>
    </tr>
  </tbody>
</table>
<p><b>Request parameters</b></p>

<table border="0" class="bodyTable">
  <thead>
    
<tr class="a">
      
<th>Parameter </th>
      
<th>Meaning </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td><i>as named in the configuration</i> </td>
      
<td>See <a href="#SelectFromContentDistributor"><tt>SelectFromContentDistributor</tt></a>. </td>
    </tr>
  </tbody>
</table>
<p><b>Example configuration:</b> </p>

<div class="source">
<div class="source">
<pre>@prefix      : &lt;http://vitro.mannlib.cornell.edu/ns/vitro/ApplicationSetup#&gt; .

:drilldown_graph_builder
    a   &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.rdf.graphbuilder.GraphBuilder&gt; ,
        &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.rdf.graphbuilder.DrillDownGraphBuilder&gt; ;
    :topLevelGraphBuilder :top_level_builder ;
    :childGraphBuilder :child_graph_builder ;
    :drillDownQuery &quot;&quot;&quot;
      PREFIX foo: &amp;lt;http://some.silly.domain/foo#&amp;gt;
      SELECT ?article ?subjectArea
      WHERE {
        foo:author_123 foo:writes ?article ;
        ?article foo:pertainsTo ?subjectArea .
      }
    &quot;&quot;&quot; .

:top_level_graph_builder
    a   &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.rdf.graphbuilder.GraphBuilder&gt; ,
        &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.rdf.graphbuilder.ConstructQueryGraphBuilder&gt; ;
    :literalBinding &quot;subjectArea&quot; ;
    :constructQuery &quot;&quot;&quot;
      PREFIX foo: &amp;lt;http://some.silly.domain/foo#&amp;gt;
      CONSTRUCT {
        ?author foo:writes ?article ;
        ?article foo:pertainsTo ?subjectArea .
      }
      WHERE {
        ?author foo:writes ?article ;
        ?article ?property ?subjectArea .
      }
    &quot;&quot;&quot; .
    
:child_graph_builder
    a   &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.rdf.graphbuilder.GraphBuilder&gt; ,
        &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.rdf.graphbuilder.ConstructQueryGraphBuilder&gt; ;
    :literalBinding &quot;subjectArea&quot; ;
    :constructQuery &quot;&quot;&quot;
      PREFIX foo: &amp;lt;http://some.silly.domain/foo#&amp;gt;
      CONSTRUCT {
        ?article ?property ?subjectArea .
      }
      WHERE {
        ?article ?property ?subjectArea .
      }
    &quot;&quot;&quot; .
</pre></div></div>
<hr /></div></div>
<div class="section">
<h2><a name="adecorator_package"></a>/decorator package</h2>
<div class="section">
<h3><a name="JavaScriptTransformDistributor"></a><tt>JavaScriptTransformDistributor</tt></h3>
<p><img src="images/uml_JavaScriptTransformDistributor.png" alt="UML for JavaScriptTransformDistributor" /></p>
<p><b>Description</b></p>
<p>A wrapper that uses a JavaScript function to transform the output of the wrapped distributor.</p>
<p>JavaScript code is provided by an inline script and optional script files loaded from the webapp. There must be a <tt>transform()</tt> function that accepts a String as argument (the output of the wrapped distributor), and returns a String as result.</p>
<p>A <tt>org.apache.commons.logging.Log</tt> Java object is created and bound to a global JavaScript variable called <tt>logger</tt>. The script can write to the VIVO log file by calling <tt>logger.error()</tt>, <tt>logger.debug()</tt>, etc. The category of the <tt>Log</tt> is <tt>edu.cornell.library.scholars.webapp.controller.api.distribute.decorator.JavaScriptTransformDistributor.[actionName]</tt>. The logging level can be set by the usual mechanisms.</p>
<p><b>Configuration properties</b></p>

<table border="0" class="bodyTable">
  <thead>
    
<tr class="a">
      
<th>Property </th>
      
<th>Meaning </th>
      
<th>How many? </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td><tt>actionName</tt> </td>
      
<td>Associates the instance with an HTTP request. </td>
      
<td>exactly one </td>
    </tr>
    
<tr class="a">
      
<td><tt>contentType</tt> </td>
      
<td>The MIME type to be sent in the HTTP response header. </td>
      
<td>exactly one </td>
    </tr>
    
<tr class="b">
      
<td><tt>script</tt> </td>
      
<td>A string of JavaScript to be interpreted and executed. It must contain a function named <tt>transform</tt> which accepts a String as argument and returns a String as result. </td>
      
<td>exactly one </td>
    </tr>
    
<tr class="a">
      
<td><tt>supportingScript</tt> </td>
      
<td>The path to a JavaScript file in the webapp. The path must be as specified for <a class="externalLink" href="https://docs.oracle.com/javaee/7/api/javax/servlet/ServletContext.html#getResource-java.lang.String-"><tt>ServletContext.getResource()</tt></a>. That is, it must begin with a &#x2018;/&#x2019; and is interpreted as relative to the context root of the webapp. </td>
      
<td>zero or more </td>
    </tr>
    
<tr class="b">
      
<td><tt>child</tt> </td>
      
<td>The &#x201c;wrapped&#x201d; Data Distributor. </td>
      
<td>exactly one </td>
    </tr>
  </tbody>
</table>
<p><b>Request parameters</b></p>

<table border="0" class="bodyTable">
  <thead>
    
<tr class="a">
      
<th>Parameter </th>
      
<th>Meaning </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td><i>as required by the child distributor</i> </td>
      
<td>The request context will be passed to the child. </td>
    </tr>
  </tbody>
</table>
<p><b>Example configuration:</b> </p>
<p>In this example, the &#x201c;Hello, World&#x201d; distributor is wrapped with a script that will add exclamation marks to the response as emphasis.</p>
<p>Note that </p>

<ul>
  
<li>The wrapper must have an <tt>actionName</tt> that matches the request.</li>
  
<li>The child must also have an <tt>actionName</tt>, but it is arbitrary, since the child will be invoked by its <tt>child</tt> relationship to the wrapper.</li>
</ul>

<div class="source">
<div class="source">
<pre>@prefix : &lt;http://vitro.mannlib.cornell.edu/ns/vitro/ApplicationSetup#&gt; .

:enthusiastic_wrapper_distributor
    a   &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.DataDistributor&gt; ,
        &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.decorator.JavaScriptTransformDistributor&gt; ;
    :actionName &quot;hello&quot; ;
    :contentType &quot;text/plain&quot; ;
    :child :hello_distributor ;
    :script &quot;&quot;&quot;
        function transform(rawOutput) {
            return rawOutput + &quot;!!! OMG!!!&quot;
        }
    &quot;&quot;&quot; .

:hello_distributor
    a   &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.DataDistributor&gt; ,
        &lt;java:edu.cornell.library.scholars.webapp.controller.api.distribute.examples.HelloDistributor&gt; ;
    :actionName &quot;&quot; .
</pre></div></div>
<p><b>Example request:</b> </p>

<div class="source">
<div class="source">
<pre>http://localhost:8080/vivo/api/dataRequest/hello?name=World
</pre></div></div>
<hr /></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                   2017.
          All rights reserved.    
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
